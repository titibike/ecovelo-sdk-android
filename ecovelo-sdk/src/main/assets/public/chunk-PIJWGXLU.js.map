{
  "version": 3,
  "sources": ["src/app/services/internal/cookies.service.ts"],
  "sourcesContent": ["import { Injectable, signal } from '@angular/core'\nimport { Platform } from '@ionic/angular'\nimport { StorageService } from '../utils/storage.service'\nimport { AlertController } from '@ionic/angular/standalone'\nimport { TranslateService } from '@ngx-translate/core'\n\nexport type CoookiesState =\n  | {\n      state: 'idle'\n    }\n  | {\n      state: 'not_already_set'\n    }\n  | {\n      state: 'already_set'\n      preferences: {\n        necessary: boolean\n        analytics: boolean\n      }\n    }\n@Injectable({\n  providedIn: 'root',\n})\nexport class CookiesService {\n  public cookiesState = signal<CoookiesState>({\n    state: 'idle',\n  })\n\n  constructor(\n    public platform: Platform,\n    private storage: StorageService,\n    private alertController: AlertController,\n    private translate: TranslateService\n  ) {}\n\n  public async storePreferences(preferences: {\n    necessary: boolean\n    analytics: boolean\n  }) {\n    const state: CoookiesState = {\n      state: 'already_set',\n      preferences,\n    }\n    this.cookiesState.set(state)\n    await this.storage.set('cookiesSettings', state)\n  }\n\n  async getPreferences() {\n    return new Promise(async (resolve, reject) => {\n      this.storage\n        .get('cookiesSettings')\n        .then(async (state: CoookiesState) => {\n          if (state && state.state === 'already_set') {\n            this.cookiesState.set(state)\n          } else {\n            this.cookiesState.set({ state: 'not_already_set' })\n          }\n          resolve(state)\n        })\n        .catch((e) => {\n          reject(e)\n        })\n    })\n  }\n\n  async presentCookiesAlert() {\n    const alert = await this.alertController.create({\n      header: this.translate.instant('cookies.alert.header'),\n      message: this.translate.instant('cookies.alert.message'),\n      buttons: [\n        {\n          text: this.translate.instant('cookies.alert.close'),\n          role: 'cancel',\n        },\n        {\n          text: this.translate.instant('cookies.alert.accept'),\n          handler: () => {\n            const preferences = {\n              necessary: true,\n              analytics: true,\n            }\n            this.storePreferences(preferences)\n          },\n        },\n      ],\n    })\n    await alert.present()\n  }\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAuBM,IAAO,kBAAP,MAAO,gBAAc;EAKzB,YACS,UACC,SACA,iBACA,WAA2B;AAH5B,SAAA,WAAA;AACC,SAAA,UAAA;AACA,SAAA,kBAAA;AACA,SAAA,YAAA;AARH,SAAA,eAAe,OAAsB;MAC1C,OAAO;KACR;EAOE;EAEU,iBAAiB,aAG7B;;AACC,YAAM,QAAuB;QAC3B,OAAO;QACP;;AAEF,WAAK,aAAa,IAAI,KAAK;AAC3B,YAAM,KAAK,QAAQ,IAAI,mBAAmB,KAAK;IACjD;;EAEM,iBAAc;;AAClB,aAAO,IAAI,QAAQ,CAAO,SAAS,WAAU;AAC3C,aAAK,QACF,IAAI,iBAAiB,EACrB,KAAK,CAAO,UAAwB;AACnC,cAAI,SAAS,MAAM,UAAU,eAAe;AAC1C,iBAAK,aAAa,IAAI,KAAK;UAC7B,OAAO;AACL,iBAAK,aAAa,IAAI,EAAE,OAAO,kBAAiB,CAAE;UACpD;AACA,kBAAQ,KAAK;QACf,EAAC,EACA,MAAM,CAAC,MAAK;AACX,iBAAO,CAAC;QACV,CAAC;MACL,EAAC;IACH;;EAEM,sBAAmB;;AACvB,YAAM,QAAQ,MAAM,KAAK,gBAAgB,OAAO;QAC9C,QAAQ,KAAK,UAAU,QAAQ,sBAAsB;QACrD,SAAS,KAAK,UAAU,QAAQ,uBAAuB;QACvD,SAAS;UACP;YACE,MAAM,KAAK,UAAU,QAAQ,qBAAqB;YAClD,MAAM;;UAER;YACE,MAAM,KAAK,UAAU,QAAQ,sBAAsB;YACnD,SAAS,MAAK;AACZ,oBAAM,cAAc;gBAClB,WAAW;gBACX,WAAW;;AAEb,mBAAK,iBAAiB,WAAW;YACnC;;;OAGL;AACD,YAAM,MAAM,QAAO;IACrB;;;;mCAhEW,iBAAc,mBAAA,QAAA,GAAA,mBAAA,cAAA,GAAA,mBAAA,eAAA,GAAA,mBAAA,gBAAA,CAAA;AAAA;mFAAd,iBAAc,SAAd,gBAAc,WAAA,YAFb,OAAM,CAAA;AAEd,IAAO,iBAAP;;sEAAO,gBAAc,CAAA;UAH1B;WAAW;MACV,YAAY;KACb;;;",
  "names": []
}
