{"version":3,"sources":["node_modules/@capacitor-mlkit/barcode-scanning/dist/esm/web.js"],"sourcesContent":["import { CapacitorException, ExceptionCode, WebPlugin } from '@capacitor/core';\nimport { BarcodeValueType, LensFacing } from './definitions';\nexport class BarcodeScannerWeb extends WebPlugin {\n  constructor() {\n    super(...arguments);\n    this._isSupported = 'BarcodeDetector' in window;\n    this.errorVideoElementMissing = 'videoElement must be provided.';\n    this.eventBarcodesScanned = 'barcodesScanned';\n  }\n  async startScan(options) {\n    if (!this._isSupported) {\n      throw this.createUnimplementedException();\n    }\n    if (!(options === null || options === void 0 ? void 0 : options.videoElement)) {\n      throw new Error(this.errorVideoElementMissing);\n    }\n    this.videoElement = options.videoElement;\n    this.stream = await navigator.mediaDevices.getUserMedia({\n      video: {\n        facingMode: {\n          ideal: (options === null || options === void 0 ? void 0 : options.lensFacing) === LensFacing.Front ? 'user' : 'environment'\n        }\n      },\n      audio: false\n    });\n    options.videoElement.srcObject = this.stream;\n    await options.videoElement.play();\n    const barcodeDetector = new BarcodeDetector();\n    this.intervalId = window.setInterval(async () => {\n      if (!options.videoElement) {\n        return;\n      }\n      const barcodes = await barcodeDetector.detect(options.videoElement);\n      if (barcodes.length === 0) {\n        return;\n      } else {\n        this.handleScannedBarcodes(barcodes);\n      }\n    }, 500);\n  }\n  async stopScan() {\n    if (!this._isSupported) {\n      throw this.createUnimplementedException();\n    }\n    if (this.intervalId) {\n      clearInterval(this.intervalId);\n      this.intervalId = undefined;\n    }\n    if (this.stream) {\n      this.stream.getTracks().forEach(track => track.stop());\n      this.stream = undefined;\n    }\n    if (this.videoElement) {\n      this.videoElement.srcObject = null;\n      this.videoElement = undefined;\n    }\n  }\n  async readBarcodesFromImage(_options) {\n    throw this.createUnimplementedException();\n  }\n  async scan() {\n    throw this.createUnimplementedException();\n  }\n  async isSupported() {\n    return {\n      supported: this._isSupported\n    };\n  }\n  async enableTorch() {\n    throw this.createUnimplementedException();\n  }\n  async disableTorch() {\n    throw this.createUnimplementedException();\n  }\n  async toggleTorch() {\n    throw this.createUnimplementedException();\n  }\n  async isTorchEnabled() {\n    throw this.createUnimplementedException();\n  }\n  async isTorchAvailable() {\n    return {\n      available: false\n    };\n  }\n  async setZoomRatio(_options) {\n    throw this.createUnimplementedException();\n  }\n  async getZoomRatio() {\n    throw this.createUnimplementedException();\n  }\n  async getMinZoomRatio() {\n    throw this.createUnimplementedException();\n  }\n  async getMaxZoomRatio() {\n    throw this.createUnimplementedException();\n  }\n  async openSettings() {\n    throw this.createUnimplementedException();\n  }\n  async isGoogleBarcodeScannerModuleAvailable() {\n    throw this.createUnimplementedException();\n  }\n  async installGoogleBarcodeScannerModule() {\n    throw this.createUnimplementedException();\n  }\n  async checkPermissions() {\n    try {\n      const result = await navigator.permissions.query({\n        name: 'camera'\n      });\n      return {\n        camera: result.state\n      };\n    } catch (error) {\n      return {\n        camera: 'prompt'\n      };\n    }\n  }\n  async requestPermissions() {\n    try {\n      const stream = await navigator.mediaDevices.getUserMedia({\n        video: true\n      });\n      stream.getTracks().forEach(track => track.stop());\n      return {\n        camera: 'granted'\n      };\n    } catch (error) {\n      return {\n        camera: 'denied'\n      };\n    }\n  }\n  createUnimplementedException() {\n    return new CapacitorException('This method is not implemented on web.', ExceptionCode.Unimplemented);\n  }\n  handleScannedBarcodes(barcodes) {\n    const result = {\n      barcodes: barcodes.map(barcode => ({\n        cornerPoints: [[barcode.cornerPoints[0].x, barcode.cornerPoints[0].y], [barcode.cornerPoints[1].x, barcode.cornerPoints[1].y], [barcode.cornerPoints[2].x, barcode.cornerPoints[2].y], [barcode.cornerPoints[3].x, barcode.cornerPoints[3].y]],\n        displayValue: barcode.rawValue,\n        rawValue: barcode.rawValue,\n        format: barcode.format.toUpperCase(),\n        valueType: BarcodeValueType.Unknown\n      }))\n    };\n    this.notifyListeners(this.eventBarcodesScanned, result);\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;AAEO,IAAM,oBAAN,cAAgC,UAAU;AAAA,EAC/C,cAAc;AACZ,UAAM,GAAG,SAAS;AAClB,SAAK,eAAe,qBAAqB;AACzC,SAAK,2BAA2B;AAChC,SAAK,uBAAuB;AAAA,EAC9B;AAAA,EACM,UAAU,SAAS;AAAA;AACvB,UAAI,CAAC,KAAK,cAAc;AACtB,cAAM,KAAK,6BAA6B;AAAA,MAC1C;AACA,UAAI,EAAE,YAAY,QAAQ,YAAY,SAAS,SAAS,QAAQ,eAAe;AAC7E,cAAM,IAAI,MAAM,KAAK,wBAAwB;AAAA,MAC/C;AACA,WAAK,eAAe,QAAQ;AAC5B,WAAK,SAAS,MAAM,UAAU,aAAa,aAAa;AAAA,QACtD,OAAO;AAAA,UACL,YAAY;AAAA,YACV,QAAQ,YAAY,QAAQ,YAAY,SAAS,SAAS,QAAQ,gBAAgB,WAAW,QAAQ,SAAS;AAAA,UAChH;AAAA,QACF;AAAA,QACA,OAAO;AAAA,MACT,CAAC;AACD,cAAQ,aAAa,YAAY,KAAK;AACtC,YAAM,QAAQ,aAAa,KAAK;AAChC,YAAM,kBAAkB,IAAI,gBAAgB;AAC5C,WAAK,aAAa,OAAO,YAAY,MAAY;AAC/C,YAAI,CAAC,QAAQ,cAAc;AACzB;AAAA,QACF;AACA,cAAM,WAAW,MAAM,gBAAgB,OAAO,QAAQ,YAAY;AAClE,YAAI,SAAS,WAAW,GAAG;AACzB;AAAA,QACF,OAAO;AACL,eAAK,sBAAsB,QAAQ;AAAA,QACrC;AAAA,MACF,IAAG,GAAG;AAAA,IACR;AAAA;AAAA,EACM,WAAW;AAAA;AACf,UAAI,CAAC,KAAK,cAAc;AACtB,cAAM,KAAK,6BAA6B;AAAA,MAC1C;AACA,UAAI,KAAK,YAAY;AACnB,sBAAc,KAAK,UAAU;AAC7B,aAAK,aAAa;AAAA,MACpB;AACA,UAAI,KAAK,QAAQ;AACf,aAAK,OAAO,UAAU,EAAE,QAAQ,WAAS,MAAM,KAAK,CAAC;AACrD,aAAK,SAAS;AAAA,MAChB;AACA,UAAI,KAAK,cAAc;AACrB,aAAK,aAAa,YAAY;AAC9B,aAAK,eAAe;AAAA,MACtB;AAAA,IACF;AAAA;AAAA,EACM,sBAAsB,UAAU;AAAA;AACpC,YAAM,KAAK,6BAA6B;AAAA,IAC1C;AAAA;AAAA,EACM,OAAO;AAAA;AACX,YAAM,KAAK,6BAA6B;AAAA,IAC1C;AAAA;AAAA,EACM,cAAc;AAAA;AAClB,aAAO;AAAA,QACL,WAAW,KAAK;AAAA,MAClB;AAAA,IACF;AAAA;AAAA,EACM,cAAc;AAAA;AAClB,YAAM,KAAK,6BAA6B;AAAA,IAC1C;AAAA;AAAA,EACM,eAAe;AAAA;AACnB,YAAM,KAAK,6BAA6B;AAAA,IAC1C;AAAA;AAAA,EACM,cAAc;AAAA;AAClB,YAAM,KAAK,6BAA6B;AAAA,IAC1C;AAAA;AAAA,EACM,iBAAiB;AAAA;AACrB,YAAM,KAAK,6BAA6B;AAAA,IAC1C;AAAA;AAAA,EACM,mBAAmB;AAAA;AACvB,aAAO;AAAA,QACL,WAAW;AAAA,MACb;AAAA,IACF;AAAA;AAAA,EACM,aAAa,UAAU;AAAA;AAC3B,YAAM,KAAK,6BAA6B;AAAA,IAC1C;AAAA;AAAA,EACM,eAAe;AAAA;AACnB,YAAM,KAAK,6BAA6B;AAAA,IAC1C;AAAA;AAAA,EACM,kBAAkB;AAAA;AACtB,YAAM,KAAK,6BAA6B;AAAA,IAC1C;AAAA;AAAA,EACM,kBAAkB;AAAA;AACtB,YAAM,KAAK,6BAA6B;AAAA,IAC1C;AAAA;AAAA,EACM,eAAe;AAAA;AACnB,YAAM,KAAK,6BAA6B;AAAA,IAC1C;AAAA;AAAA,EACM,wCAAwC;AAAA;AAC5C,YAAM,KAAK,6BAA6B;AAAA,IAC1C;AAAA;AAAA,EACM,oCAAoC;AAAA;AACxC,YAAM,KAAK,6BAA6B;AAAA,IAC1C;AAAA;AAAA,EACM,mBAAmB;AAAA;AACvB,UAAI;AACF,cAAM,SAAS,MAAM,UAAU,YAAY,MAAM;AAAA,UAC/C,MAAM;AAAA,QACR,CAAC;AACD,eAAO;AAAA,UACL,QAAQ,OAAO;AAAA,QACjB;AAAA,MACF,SAAS,OAAO;AACd,eAAO;AAAA,UACL,QAAQ;AAAA,QACV;AAAA,MACF;AAAA,IACF;AAAA;AAAA,EACM,qBAAqB;AAAA;AACzB,UAAI;AACF,cAAM,SAAS,MAAM,UAAU,aAAa,aAAa;AAAA,UACvD,OAAO;AAAA,QACT,CAAC;AACD,eAAO,UAAU,EAAE,QAAQ,WAAS,MAAM,KAAK,CAAC;AAChD,eAAO;AAAA,UACL,QAAQ;AAAA,QACV;AAAA,MACF,SAAS,OAAO;AACd,eAAO;AAAA,UACL,QAAQ;AAAA,QACV;AAAA,MACF;AAAA,IACF;AAAA;AAAA,EACA,+BAA+B;AAC7B,WAAO,IAAI,mBAAmB,0CAA0C,cAAc,aAAa;AAAA,EACrG;AAAA,EACA,sBAAsB,UAAU;AAC9B,UAAM,SAAS;AAAA,MACb,UAAU,SAAS,IAAI,cAAY;AAAA,QACjC,cAAc,CAAC,CAAC,QAAQ,aAAa,CAAC,EAAE,GAAG,QAAQ,aAAa,CAAC,EAAE,CAAC,GAAG,CAAC,QAAQ,aAAa,CAAC,EAAE,GAAG,QAAQ,aAAa,CAAC,EAAE,CAAC,GAAG,CAAC,QAAQ,aAAa,CAAC,EAAE,GAAG,QAAQ,aAAa,CAAC,EAAE,CAAC,GAAG,CAAC,QAAQ,aAAa,CAAC,EAAE,GAAG,QAAQ,aAAa,CAAC,EAAE,CAAC,CAAC;AAAA,QAC7O,cAAc,QAAQ;AAAA,QACtB,UAAU,QAAQ;AAAA,QAClB,QAAQ,QAAQ,OAAO,YAAY;AAAA,QACnC,WAAW,iBAAiB;AAAA,MAC9B,EAAE;AAAA,IACJ;AACA,SAAK,gBAAgB,KAAK,sBAAsB,MAAM;AAAA,EACxD;AACF;","names":[],"x_google_ignoreList":[0]}