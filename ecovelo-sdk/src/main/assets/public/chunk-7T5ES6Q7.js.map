{"version":3,"sources":["node_modules/@capacitor-community/native-audio/dist/esm/index.js","src/app/services/utils/native-audio.service.ts"],"sourcesContent":["import { registerPlugin } from '@capacitor/core';\nconst NativeAudio = registerPlugin('NativeAudio', {\n  web: () => import('./web').then(m => new m.NativeAudioWeb())\n});\nexport * from './definitions';\nexport { NativeAudio };\n","import { Injectable } from '@angular/core'\nimport { NativeAudio } from '@capacitor-community/native-audio'\nimport { Capacitor } from '@capacitor/core'\n\ninterface AudioAsset {\n  assetId: string\n  assetPath: string\n  audioChannelNum: number\n  volume: number\n  isLoaded: boolean\n}\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class NativeAudioService {\n  private loadedAssets: Map<string, AudioAsset> = new Map()\n\n  constructor() {}\n\n  /**\n   * Précharge un asset audio seulement s'il n'est pas déjà chargé\n   */\n  async preloadAsset(\n    assetId: string,\n    assetPath: string,\n    audioChannelNum: number = 1,\n    volume: number = 0.8\n  ): Promise<void> {\n    if (this.loadedAssets.has(assetId)) {\n      return\n    }\n    try {\n      const finalPath = Capacitor.isNativePlatform()\n        ? `public/${assetPath}`\n        : assetPath\n\n      await NativeAudio.preload({\n        assetId,\n        assetPath: finalPath,\n        audioChannelNum,\n        volume,\n        isUrl: false,\n      })\n      this.loadedAssets.set(assetId, {\n        assetId,\n        assetPath: finalPath,\n        audioChannelNum,\n        volume,\n        isLoaded: true,\n      })\n    } catch (error) {\n      if (\n        error &&\n        typeof error === 'object' &&\n        'message' in error &&\n        typeof error.message === 'string' &&\n        error.message.includes('already exists')\n      ) {\n        this.loadedAssets.set(assetId, {\n          assetId,\n          assetPath: Capacitor.isNativePlatform()\n            ? `public/${assetPath}`\n            : assetPath,\n          audioChannelNum,\n          volume,\n          isLoaded: true,\n        })\n      } else {\n        console.error(`Failed to preload audio asset ${assetId}:`, error)\n        throw error\n      }\n    }\n  }\n\n  /**\n   * Joue un asset audio\n   */\n  async play(assetId: string, time?: number): Promise<void> {\n    if (!this.loadedAssets.has(assetId)) {\n      console.warn(`Audio asset ${assetId} not loaded, cannot play`)\n      return\n    }\n\n    try {\n      await NativeAudio.play({\n        assetId,\n        time,\n      })\n    } catch (error) {\n      console.error(`Failed to play audio asset ${assetId}:`, error)\n    }\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;AACA,IAAM,cAAc,eAAe,eAAe;AAAA,EAChD,KAAK,MAAM,OAAO,mBAAO,EAAE,KAAK,OAAK,IAAI,EAAE,eAAe,CAAC;AAC7D,CAAC;;;ACYK,IAAO,sBAAP,MAAO,oBAAkB;EAG7B,cAAA;AAFQ,SAAA,eAAwC,oBAAI,IAAG;EAExC;;;;EAKT,aACJ,SACA,WACA,kBAA0B,GAC1B,SAAiB,KAAG;;AAEpB,UAAI,KAAK,aAAa,IAAI,OAAO,GAAG;AAClC;MACF;AACA,UAAI;AACF,cAAM,YAAY,UAAU,iBAAgB,IACxC,UAAU,SAAS,KACnB;AAEJ,cAAM,YAAY,QAAQ;UACxB;UACA,WAAW;UACX;UACA;UACA,OAAO;SACR;AACD,aAAK,aAAa,IAAI,SAAS;UAC7B;UACA,WAAW;UACX;UACA;UACA,UAAU;SACX;MACH,SAAS,OAAO;AACd,YACE,SACA,OAAO,UAAU,YACjB,aAAa,SACb,OAAO,MAAM,YAAY,YACzB,MAAM,QAAQ,SAAS,gBAAgB,GACvC;AACA,eAAK,aAAa,IAAI,SAAS;YAC7B;YACA,WAAW,UAAU,iBAAgB,IACjC,UAAU,SAAS,KACnB;YACJ;YACA;YACA,UAAU;WACX;QACH,OAAO;AACL,kBAAQ,MAAM,iCAAiC,OAAO,KAAK,KAAK;AAChE,gBAAM;QACR;MACF;IACF;;;;;EAKM,KAAK,SAAiB,MAAa;;AACvC,UAAI,CAAC,KAAK,aAAa,IAAI,OAAO,GAAG;AACnC,gBAAQ,KAAK,eAAe,OAAO,0BAA0B;AAC7D;MACF;AAEA,UAAI;AACF,cAAM,YAAY,KAAK;UACrB;UACA;SACD;MACH,SAAS,OAAO;AACd,gBAAQ,MAAM,8BAA8B,OAAO,KAAK,KAAK;MAC/D;IACF;;;;mCA7EW,qBAAkB;AAAA;uFAAlB,qBAAkB,SAAlB,oBAAkB,WAAA,YAFjB,OAAM,CAAA;AAEd,IAAO,qBAAP;;sEAAO,oBAAkB,CAAA;UAH9B;WAAW;MACV,YAAY;KACb;;;","names":[],"x_google_ignoreList":[0]}