{
  "version": 3,
  "sources": ["src/app/services/external/recaptcha.service.ts"],
  "sourcesContent": ["import { Injectable } from '@angular/core'\nimport { environment } from 'src/environments/environment'\n\n// DÃ©claration globale pour grecaptcha\ndeclare global {\n  interface Window {\n    grecaptcha: any\n  }\n}\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class RecaptchaService {\n  private readonly RECAPTCHA_V3_SITE_KEY = environment.recaptchaV3SiteKey\n  private scriptElement: HTMLScriptElement | null = null\n\n  loadRecaptcha(): Promise<void> {\n    return new Promise((resolve) => {\n      if (typeof window.grecaptcha === 'undefined') {\n        this.scriptElement = document.createElement('script')\n        this.scriptElement.src = `https://www.google.com/recaptcha/api.js?render=${this.RECAPTCHA_V3_SITE_KEY}`\n        this.scriptElement.async = true\n        this.scriptElement.defer = true\n        document.head.appendChild(this.scriptElement)\n        this.scriptElement.onload = () => {\n          resolve()\n        }\n      } else {\n        resolve()\n      }\n    })\n  }\n\n  executeRecaptcha(action: string): Promise<string> {\n    return new Promise((resolve, reject) => {\n      if (typeof window.grecaptcha === 'undefined') {\n        reject('reCAPTCHA is not loaded')\n        return\n      }\n      window.grecaptcha.ready(() => {\n        window.grecaptcha\n          .execute(this.RECAPTCHA_V3_SITE_KEY, { action })\n          .then(resolve, reject)\n      })\n    })\n  }\n\n  unloadRecaptcha(): void {\n    // Remove the script element if it exists\n    if (this.scriptElement) {\n      document.head.removeChild(this.scriptElement)\n      this.scriptElement = null\n    }\n\n    // Remove all potential reCAPTCHA elements from the DOM\n    const recaptchaElements =\n      document.getElementsByClassName('grecaptcha-badge')\n    while (recaptchaElements.length > 0) {\n      const element = recaptchaElements[0]\n      element.parentNode?.removeChild(element)\n    }\n\n    // Remove the grecaptcha object from the window\n    delete window.grecaptcha\n  }\n}\n"],
  "mappings": ";;;;;;;;;;AAaM,IAAO,oBAAP,MAAO,kBAAgB;EAH7B,cAAA;AAImB,SAAA,wBAAwB,YAAY;AAC7C,SAAA,gBAA0C;;EAElD,gBAAa;AACX,WAAO,IAAI,QAAQ,CAAC,YAAW;AAC7B,UAAI,OAAO,OAAO,eAAe,aAAa;AAC5C,aAAK,gBAAgB,SAAS,cAAc,QAAQ;AACpD,aAAK,cAAc,MAAM,kDAAkD,KAAK,qBAAqB;AACrG,aAAK,cAAc,QAAQ;AAC3B,aAAK,cAAc,QAAQ;AAC3B,iBAAS,KAAK,YAAY,KAAK,aAAa;AAC5C,aAAK,cAAc,SAAS,MAAK;AAC/B,kBAAO;QACT;MACF,OAAO;AACL,gBAAO;MACT;IACF,CAAC;EACH;EAEA,iBAAiB,QAAc;AAC7B,WAAO,IAAI,QAAQ,CAAC,SAAS,WAAU;AACrC,UAAI,OAAO,OAAO,eAAe,aAAa;AAC5C,eAAO,yBAAyB;AAChC;MACF;AACA,aAAO,WAAW,MAAM,MAAK;AAC3B,eAAO,WACJ,QAAQ,KAAK,uBAAuB,EAAE,OAAM,CAAE,EAC9C,KAAK,SAAS,MAAM;MACzB,CAAC;IACH,CAAC;EACH;EAEA,kBAAe;AAhDjB;AAkDI,QAAI,KAAK,eAAe;AACtB,eAAS,KAAK,YAAY,KAAK,aAAa;AAC5C,WAAK,gBAAgB;IACvB;AAGA,UAAM,oBACJ,SAAS,uBAAuB,kBAAkB;AACpD,WAAO,kBAAkB,SAAS,GAAG;AACnC,YAAM,UAAU,kBAAkB,CAAC;AACnC,oBAAQ,eAAR,mBAAoB,YAAY;IAClC;AAGA,WAAO,OAAO;EAChB;;;mCApDW,mBAAgB;AAAA;qFAAhB,mBAAgB,SAAhB,kBAAgB,WAAA,YAFf,OAAM,CAAA;AAEd,IAAO,mBAAP;;sEAAO,kBAAgB,CAAA;UAH5B;WAAW;MACV,YAAY;KACb;;;",
  "names": []
}
