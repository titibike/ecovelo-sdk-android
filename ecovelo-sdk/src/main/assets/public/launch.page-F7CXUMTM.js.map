{"version":3,"sources":["node_modules/capacitor-plugin-app-tracking-transparency/dist/esm/index.js","node_modules/@capawesome/capacitor-live-update/dist/esm/index.js","src/app/services/liveupdate.service.ts","src/app/plugins/ecovelo-native.plugin.ts","src/app/services/sdk-mode.service.ts","src/app/pages/launch/launch.page.ts","src/app/pages/launch/launch.page.html"],"sourcesContent":["import { registerPlugin } from '@capacitor/core';\nconst AppTrackingTransparency = registerPlugin('AppTrackingTransparency', {\n  web: () => import('./web').then(m => new m.AppTrackingTransparencyWeb())\n});\nexport * from './definitions';\nexport { AppTrackingTransparency };\n","import { registerPlugin } from '@capacitor/core';\nconst LiveUpdate = registerPlugin('LiveUpdate', {\n  web: () => import('./web').then(m => new m.LiveUpdateWeb())\n});\nexport * from './definitions';\nexport { LiveUpdate };\n","import { Injectable } from '@angular/core'\nimport { LiveUpdate } from '@capawesome/capacitor-live-update'\nimport { Observable, Subject } from 'rxjs'\nimport { environment } from 'src/environments/environment'\n\nexport type LiveUpdateEvent =\n  | 'check_started'\n  | 'bundle_found'\n  | 'bundle_not_found'\n  | 'download_started'\n  | 'download_completed'\n  | 'reload_started'\n  | 'error'\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class LiveUpdateService {\n  constructor() {}\n\n  // Sujet privé pour émettre les événements\n  private updateSubject = new Subject<LiveUpdateEvent>()\n\n  // Observable public pour que les composants puissent s'abonner\n  public updates$: Observable<LiveUpdateEvent> =\n    this.updateSubject.asObservable()\n\n  // Méthode principale pour vérifier et appliquer les mises à jour\n  async checkForUpdate() {\n    try {\n      this.updateSubject.next('check_started')\n\n      // Recherche du dernier bundle disponible\n      const bundle = await LiveUpdate.fetchLatestBundle()\n      if (\n        bundle &&\n        bundle.bundleId &&\n        bundle.customProperties?.['timestamp'] &&\n        environment.timestamp < bundle.customProperties?.['timestamp']\n      ) {\n        const currentBundles = await LiveUpdate.getBundles()\n        const currentBundle = await LiveUpdate.getCurrentBundle()\n\n        if (\n          currentBundles.bundleIds.includes(bundle.bundleId) &&\n          currentBundle.bundleId === bundle.bundleId\n        ) {\n          this.updateSubject.next('bundle_not_found')\n          return\n        } else {\n          this.updateSubject.next('bundle_found')\n        }\n\n        // Démarrage du téléchargement du bundle\n        this.updateSubject.next('download_started')\n\n        const syncResult = await LiveUpdate.sync()\n        if (syncResult.nextBundleId) {\n          this.updateSubject.next('download_completed')\n          // Pause de 500ms avant le redémarrage pour laisser le temps à l'interface utilisateur de réagir\n          // Et que ca ne fasse pas un clignotement non plus\n          await new Promise((resolve) => setTimeout(resolve, 500))\n          this.updateSubject.next('reload_started')\n          await LiveUpdate.reload()\n        } else {\n          this.updateSubject.next('bundle_not_found')\n        }\n      } else {\n        this.updateSubject.next('bundle_not_found')\n      }\n    } catch (error) {\n      console.error('Erreur lors de la mise à jour LiveUpdate :', error)\n      this.updateSubject.next('error')\n    }\n  }\n\n  // Méthode pour indiquer que l'application s'est chargée\n  async ready() {\n    await LiveUpdate.ready()\n  }\n}\n","import { registerPlugin } from '@capacitor/core'\n\n/**\n * Interface du plugin natif EcoveloNative.\n * Ce plugin est disponible uniquement en mode SDK (pas en mode standalone).\n */\nexport interface EcoveloNativePlugin {\n  // ============ AUTHENTIFICATION ============\n\n  /**\n   * Récupère le token d'accès OAuth2 depuis l'app hôte.\n   */\n  getAccessToken(): Promise<{ token: string | null; hasToken: boolean }>\n\n  /**\n   * Récupère l'ID Token OIDC.\n   */\n  getIdToken(): Promise<{ token: string | null; hasToken: boolean }>\n\n  /**\n   * Récupère les informations utilisateur.\n   */\n  getUserInfo(): Promise<{\n    authenticated: boolean\n    sub?: string\n    email?: string\n    firstName?: string\n    lastName?: string\n    phone?: string\n    phoneVerified?: boolean\n  }>\n\n  /**\n   * Rafraîchit le token d'accès.\n   */\n  refreshToken(): Promise<{ success: boolean; token: string | null }>\n\n  /**\n   * Vérifie si l'utilisateur est authentifié.\n   */\n  isAuthenticated(): Promise<{ authenticated: boolean }>\n\n  /**\n   * Demande la connexion à l'app hôte.\n   * Déclenche le callback onLoginRequired côté natif.\n   * L'app hôte lancera le SSO mon-compte.bzh.\n   */\n  requestLogin(): Promise<{ requested: boolean }>\n\n  // ============ CONFIGURATION ============\n\n  /**\n   * Récupère la configuration du SDK.\n   */\n  getConfig(): Promise<{\n    territoryId: string\n    environment: string\n    debugMode: boolean\n    features: {\n      reservationEnabled: boolean\n      mapEnabled: boolean\n      qrCodeScanEnabled: boolean\n    }\n  }>\n\n  // ============ ÉVÉNEMENTS ============\n\n  /**\n   * Émet un événement vers l'app hôte (analytics).\n   */\n  emitEvent(options: { name: string; data?: any }): Promise<void>\n\n  // ============ NAVIGATION ============\n\n  /**\n   * Ferme le SDK et retourne à l'app hôte.\n   */\n  close(options: { result: string; data?: any }): Promise<void>\n\n  /**\n   * Déconnecte l'utilisateur.\n   */\n  logout(): Promise<{ success: boolean }>\n}\n\n/**\n * Plugin EcoveloNative.\n *\n * Usage:\n * ```typescript\n * import { EcoveloNative } from './plugins/ecovelo-native.plugin';\n *\n * const { authenticated } = await EcoveloNative.isAuthenticated();\n * ```\n */\nexport const EcoveloNative =\n  registerPlugin<EcoveloNativePlugin>('EcoveloNative')\n","import { Injectable } from '@angular/core'\nimport { Capacitor } from '@capacitor/core'\nimport { BehaviorSubject, Observable } from 'rxjs'\nimport { EcoveloNative } from '../plugins/ecovelo-native.plugin'\n\nexport interface SdkConfig {\n  territoryId: string\n  environment: string\n  debugMode: boolean\n  features: {\n    reservationEnabled: boolean\n    mapEnabled: boolean\n    qrCodeScanEnabled: boolean\n  }\n}\n\nexport interface UserInfo {\n  sub?: string\n  email?: string\n  firstName?: string\n  lastName?: string\n  phone?: string\n  phoneVerified?: boolean\n}\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class SdkModeService {\n  /**\n   * True si l'app tourne dans le SDK Breizhgo (pas en standalone).\n   */\n  readonly isSDKMode: boolean\n\n  /**\n   * Configuration du SDK (disponible uniquement en mode SDK).\n   */\n  private _config: SdkConfig | null = null\n\n  /**\n   * État de connexion (observable).\n   */\n  private _isAuthenticated = new BehaviorSubject<boolean>(false)\n  readonly isAuthenticated$: Observable<boolean> =\n    this._isAuthenticated.asObservable()\n\n  /**\n   * Informations utilisateur (observable).\n   */\n  private _userInfo = new BehaviorSubject<UserInfo | null>(null)\n  readonly userInfo$: Observable<UserInfo | null> =\n    this._userInfo.asObservable()\n\n  constructor() {\n    // Détecter si le plugin EcoveloNative est disponible\n    this.isSDKMode = Capacitor.isPluginAvailable('EcoveloNative')\n\n    if (this.isSDKMode) {\n      console.log('[SdkModeService] Mode SDK détecté - Breizhgo')\n      this.initSDKMode()\n    } else {\n      console.log('[SdkModeService] Mode standalone')\n    }\n  }\n\n  private async initSDKMode(): Promise<void> {\n    try {\n      // Charger la configuration\n      this._config = await EcoveloNative.getConfig()\n      console.log('[SdkModeService] Config:', this._config)\n\n      // Vérifier l'état d'authentification initial\n      await this.refreshAuthState()\n\n      // Écouter les mises à jour de token\n      window.addEventListener('ecovelo-token-updated', async (event: any) => {\n        console.log('[SdkModeService] Token mis à jour:', event.detail)\n        await this.refreshAuthState()\n      })\n    } catch (error) {\n      console.error('[SdkModeService] Erreur initialisation:', error)\n    }\n  }\n\n  /**\n   * Rafraîchit l'état d'authentification.\n   */\n  async refreshAuthState(): Promise<void> {\n    if (!this.isSDKMode) return\n\n    try {\n      const { authenticated } = await EcoveloNative.isAuthenticated()\n      this._isAuthenticated.next(authenticated)\n\n      if (authenticated) {\n        const userInfo = await EcoveloNative.getUserInfo()\n        if (userInfo.authenticated) {\n          this._userInfo.next({\n            sub: userInfo.sub,\n            email: userInfo.email,\n            firstName: userInfo.firstName,\n            lastName: userInfo.lastName,\n            phone: userInfo.phone,\n            phoneVerified: userInfo.phoneVerified,\n          })\n        }\n      } else {\n        this._userInfo.next(null)\n      }\n    } catch (error) {\n      console.error('[SdkModeService] Erreur refresh auth:', error)\n    }\n  }\n\n  /**\n   * Retourne la configuration SDK.\n   */\n  getConfig(): SdkConfig | null {\n    return this._config\n  }\n\n  /**\n   * Récupère le token d'accès.\n   * En mode SDK: depuis l'app hôte (Cityway)\n   * En mode standalone: depuis Cognito (à implémenter)\n   */\n  async getAccessToken(): Promise<string | null> {\n    if (this.isSDKMode) {\n      const { token, hasToken } = await EcoveloNative.getAccessToken()\n      return hasToken ? token : null\n    }\n    // Mode standalone: utiliser votre service Cognito existant\n    return null\n  }\n\n  /**\n   * Récupère l'ID Token.\n   */\n  async getIdToken(): Promise<string | null> {\n    if (this.isSDKMode) {\n      const { token, hasToken } = await EcoveloNative.getIdToken()\n      return hasToken ? token : null\n    }\n    return null\n  }\n\n  /**\n   * Vérifie si l'utilisateur est connecté.\n   */\n  async isAuthenticated(): Promise<boolean> {\n    if (this.isSDKMode) {\n      const { authenticated } = await EcoveloNative.isAuthenticated()\n      return authenticated\n    }\n    // Mode standalone\n    return false\n  }\n\n  /**\n   * Demande la connexion.\n   * En mode SDK: déclenche le callback onLoginRequired vers l'app hôte\n   * En mode standalone: redirige vers Cognito (à implémenter)\n   */\n  async requestLogin(): Promise<void> {\n    if (this.isSDKMode) {\n      console.log(\"[SdkModeService] Demande de connexion à l'app hôte\")\n      await EcoveloNative.requestLogin()\n      // L'app hôte va lancer le SSO, puis appeler updateToken()\n      // L'événement 'ecovelo-token-updated' sera émis\n    } else {\n      // Mode standalone: implémenter la redirection Cognito\n      console.log('[SdkModeService] Mode standalone - redirection Cognito')\n    }\n  }\n\n  /**\n   * Émet un événement vers l'app hôte (analytics).\n   */\n  async emitEvent(name: string, data?: any): Promise<void> {\n    if (this.isSDKMode) {\n      await EcoveloNative.emitEvent({ name, data })\n    }\n    // En mode standalone, vous pouvez aussi logger l'événement\n    console.log(`[Analytics] ${name}`, data)\n  }\n\n  /**\n   * Ferme le SDK et retourne à l'app hôte.\n   */\n  async closeSDK(result: string = 'closed'): Promise<void> {\n    if (this.isSDKMode) {\n      await EcoveloNative.close({ result })\n    }\n  }\n\n  /**\n   * Déconnecte l'utilisateur.\n   */\n  async logout(): Promise<void> {\n    if (this.isSDKMode) {\n      await EcoveloNative.logout()\n    }\n    this._isAuthenticated.next(false)\n    this._userInfo.next(null)\n  }\n}\n","import { Component, effect, OnInit, OnDestroy } from '@angular/core'\nimport { CommonModule } from '@angular/common'\nimport {\n  IonContent,\n  IonImg,\n  IonRow,\n  IonProgressBar,\n  IonCol,\n} from '@ionic/angular/standalone'\nimport { environment } from 'src/environments/environment'\nimport { StorageService } from '../../services/utils/storage.service'\nimport { Router, ActivatedRoute } from '@angular/router'\nimport { AuthService, AuthState } from 'src/app/services/external/auth.service'\nimport { TranslateModule } from '@ngx-translate/core'\nimport {\n  LiveUpdateEvent,\n  LiveUpdateService,\n} from 'src/app/services/liveupdate.service'\nimport {\n  AccountService,\n  cyclistState,\n} from 'src/app/services/api-wrappers/account.service'\nimport {\n  AppState,\n  AppstateService,\n} from 'src/app/services/internal/appstate.service'\nimport { Capacitor } from '@capacitor/core'\nimport { LaunchService } from 'src/app/services/internal/launch.service'\nimport { KYCWrapperService } from 'src/app/services/api-wrappers/kyc.service'\nimport { AppTrackingTransparency } from 'capacitor-plugin-app-tracking-transparency'\nimport { addIcons } from 'ionicons'\nimport { cloudDownloadOutline } from 'ionicons/icons'\nimport { SdkModeService } from 'src/app/services/sdk-mode.service'\n\n@Component({\n  selector: 'app-launch',\n  templateUrl: './launch.page.html',\n  styleUrls: ['./launch.page.scss'],\n  providers: [Storage, StorageService],\n  imports: [\n    IonContent,\n    CommonModule,\n    IonRow,\n    IonImg,\n    TranslateModule,\n    IonProgressBar,\n    IonCol,\n  ],\n})\nexport class LaunchPage implements OnInit, OnDestroy {\n  public program: any\n  private auth: AuthState = { state: 'SignedOut' }\n  private cyclist: cyclistState = {\n    state: 'unknown',\n    blocked_reasons: ['Unknown account state'],\n  }\n  private app: AppState\n  public isFirstVisit: boolean = false\n  public loaderStateText = 'launch.update_checking'\n  private nextUrl: string | null = null\n  public liveUpdateState: string = 'idle'\n  private updateSubscription: any\n\n  constructor(\n    private storageService: StorageService,\n    private accountService: AccountService,\n    private router: Router,\n    private authService: AuthService,\n    private liveUpdateService: LiveUpdateService,\n    private appstateService: AppstateService,\n    private route: ActivatedRoute,\n    private launchService: LaunchService,\n    private kycService: KYCWrapperService,\n    private sdkModeService: SdkModeService\n  ) {\n    this.route.queryParams.subscribe((params) => {\n      if (params['next']) {\n        this.nextUrl = params['next']\n      }\n    })\n    effect(() => {\n      this.auth = this.authService.authState()\n    })\n    effect(() => {\n      this.cyclist = this.accountService.cyclistState()\n    })\n    addIcons({\n      cloudDownloadOutline: cloudDownloadOutline,\n    })\n    // Subscribe to update events\n    this.updateSubscription = this.liveUpdateService.updates$.subscribe(\n      (event) => {\n        switch (event) {\n          case 'download_started':\n            this.liveUpdateState = 'download_started'\n            break\n          case 'download_completed':\n            this.liveUpdateState = 'download_completed'\n            break\n          case 'error':\n          case 'bundle_not_found':\n            this.liveUpdateState = 'bundle_not_found'\n            break\n        }\n      }\n    )\n  }\n\n  ngOnDestroy() {\n    if (this.updateSubscription) {\n      this.updateSubscription.unsubscribe()\n    }\n  }\n\n  async ngOnInit() {\n    this.app = await this.appstateService.getSavedAppState()\n\n    // En mode SDK, flow simplifié : charger les données puis aller à la map\n    if (this.sdkModeService.isSDKMode) {\n      console.log('[LaunchPage] Mode SDK détecté - flow simplifié')\n      try {\n        await this.loadData()\n      } catch (error) {\n        console.error('[LaunchPage] Erreur chargement données SDK:', error)\n      }\n      // En mode SDK, toujours aller à la map (l'auth est gérée par l'app hôte)\n      await this.router.navigate(['/map'], { replaceUrl: true })\n      return\n    }\n\n    // Flow standard (mode standalone)\n    if (Capacitor.getPlatform() === 'ios') {\n      try {\n        const response = await AppTrackingTransparency.getStatus()\n        if (response.status === 'notDetermined') {\n          await AppTrackingTransparency.requestPermission()\n        }\n      } catch (error) {\n        console.warn('[LaunchPage] AppTrackingTransparency error:', error)\n      }\n    }\n\n    // Create a promise that resolves after 5 seconds for the rest of the data\n    const timeoutPromise = new Promise((resolve) => setTimeout(resolve, 5000))\n\n    // Race between loadData and timeout\n    await Promise.race([this.loadData(), timeoutPromise])\n\n    // On indique au plugin liveUpdate qu'on est ready pour eviter le rollback\n    // Si on atteinds pas cet emplacement le plugin rollbackera dans la version de bundle précédente\n    if (Capacitor.isNativePlatform()) {\n      // Vérification du liveUpdate\n      try {\n        await this.checkForLiveUpdate()\n        await this.liveUpdateService.ready()\n      } catch (error) {\n        console.warn('[LaunchPage] LiveUpdate error:', error)\n      }\n    }\n\n    if (!this.app) {\n      this.appstateService.setAppState({ state: 'onboarding' })\n      await this.router.navigate(['/landing'], { replaceUrl: true })\n      return // Important: arrêter l'exécution après la navigation\n    }\n\n    switch (this.auth.state) {\n      case 'SignedIn':\n        if (\n          this.cyclist.state === 'unknown' ||\n          this.cyclist.state === 'error'\n        ) {\n          await this.waitForCyclistState()\n        }\n        if (this.app.state === 'onboarding') {\n          this.redirectOnboarding()\n        } else {\n          this.redirect()\n        }\n        break\n      case 'SignedOut':\n        await this.router.navigate(['/landing'], { replaceUrl: true })\n        break\n      default:\n        await this.router.navigate(['/map'], { replaceUrl: true })\n        break\n    }\n  }\n\n  async loadData() {\n    try {\n      // Use LaunchService to load all essential data\n      await this.launchService.loadEssentialData({\n        skipIfDataExists: false, // Always load on launch page\n        forceRefreshStations: true,\n      })\n\n      // Get the program for the template\n      this.program = await this.storageService.get('program')\n    } catch (error) {\n      console.error('Error in loadData:', error)\n    }\n  }\n\n  checkForLiveUpdate() {\n    return new Promise<void>(async (resolve, reject) => {\n      // Abonnement aux événements de mise à jour\n      const subscription = this.liveUpdateService.updates$.subscribe(\n        async (event: LiveUpdateEvent) => {\n          switch (event) {\n            case 'check_started':\n              this.loaderStateText = 'launch.update_checking'\n              break\n            case 'bundle_found':\n              this.loaderStateText = 'launch.update_available'\n              break\n            case 'bundle_not_found':\n              this.loaderStateText = 'launch.no_update'\n              subscription.unsubscribe()\n              resolve()\n              break\n            case 'download_started':\n              this.loaderStateText = 'launch.update_downloading'\n              break\n            case 'download_completed':\n              this.loaderStateText = 'launch.update_downloaded'\n              break\n            case 'reload_started':\n              this.loaderStateText = 'launch.update_app_reloading'\n              // resolve() au cas ou mais l'application devrait redemarer\n              resolve()\n              break\n            case 'error':\n              this.loaderStateText = 'launch.error'\n              subscription.unsubscribe()\n              reject('liveUpdateError')\n              break\n          }\n        }\n      )\n\n      // Déclenchement de la vérification des mises à jour\n      this.liveUpdateService.checkForUpdate()\n    })\n  }\n\n  async redirectOnboarding() {\n    if (this.cyclist.state === 'unconfirmed') {\n      if (this.accountService.hasMissingPaymentMethodOrCgu()) {\n        await this.router.navigate(['/payment-method'], {\n          replaceUrl: true,\n        })\n      } else if (\n        this.kycService.kycCompletionState() === 'missing' ||\n        this.kycService.kycCompletionState() === 'rejected'\n      ) {\n        await this.router.navigate(['/kyc'], {\n          replaceUrl: true,\n          queryParams: {\n            onboarding: 'true',\n          },\n        })\n      } else {\n        await this.router.navigate(['/map'], {\n          replaceUrl: true,\n        })\n      }\n    } else {\n      await this.router.navigate(['/map'], {\n        replaceUrl: true,\n      })\n    }\n  }\n\n  async redirect() {\n    if (\n      this.kycService.kycCompletionState() === 'missing' ||\n      this.kycService.kycCompletionState() === 'rejected'\n    ) {\n      await this.router.navigate(['/kyc'], { replaceUrl: true })\n    } else if (this.nextUrl && this.nextUrl !== '/') {\n      await this.router.navigate([this.nextUrl], { replaceUrl: true })\n    } else {\n      await this.router.navigate(['/map'], { replaceUrl: true })\n    }\n  }\n\n  async waitForCyclistState() {\n    const maxRetries = 1000\n    for (let i = 0; i < maxRetries; i++) {\n      if (this.cyclist.state !== 'unknown' && this.cyclist.state !== 'error') {\n        return\n      }\n      await new Promise((resolve) => setTimeout(resolve, 5))\n    }\n    console.warn('Cyclist state did not change within the allowed time')\n  }\n}\n","<ion-content [fullscreen]=\"true\">\n  <div class=\"ecl-launch__container logo\">\n    <ion-img\n      *ngIf=\"program\"\n      class=\"fade-in\"\n      [src]=\"program?.config?.logo\"\n      alt=\"logo\"\n    ></ion-img>\n  </div>\n  <ng-container *ngIf=\"liveUpdateState === 'download_started'\">\n    <ion-row\n      class=\"ion-margin-top ion-margin-horizontal ion-justify-content-center\"\n    >\n      <ion-col size=\"12\" size-md=\"6\" size-lg=\"4\">\n        <p class=\"ion-text-center\">\n          {{ 'launch.searching_for_updates' | translate }}\n        </p>\n      </ion-col>\n    </ion-row>\n    <ion-row\n      class=\"ion-margin-horizontal ion-margin-bottom ion-justify-content-center\"\n    >\n      <ion-col size=\"12\" size-md=\"6\" size-lg=\"4\">\n        <ion-progress-bar type=\"indeterminate\"></ion-progress-bar>\n      </ion-col>\n    </ion-row>\n  </ng-container>\n</ion-content>\n"],"mappings":"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","names":[],"x_google_ignoreList":[0,1]}