{
  "version": 3,
  "sources": ["src/app/pages/account/infos/infos.page.ts", "src/app/pages/account/infos/infos.page.html"],
  "sourcesContent": ["import { Component, effect } from '@angular/core'\nimport { CommonModule } from '@angular/common'\nimport { IonicModule } from '@ionic/angular'\nimport { FormsModule } from '@angular/forms'\nimport { HeaderComponent } from 'src/app/components/header/header.component'\nimport { TranslateModule, TranslateService } from '@ngx-translate/core'\nimport { ToastService } from 'src/app/services/utils/toast.service'\nimport {\n  AccountService,\n  cyclistState,\n} from 'src/app/services/api-wrappers/account.service'\n@Component({\n  selector: 'app-infos-page',\n  templateUrl: './infos.page.html',\n  imports: [\n    CommonModule,\n    IonicModule,\n    FormsModule,\n    HeaderComponent,\n    TranslateModule,\n  ],\n})\nexport class InfosPage {\n  cyclistState: cyclistState = {\n    state: 'unknown',\n    blocked_reasons: ['Unknown account state'],\n  }\n  nextUrl: string | null = null\n  emailValue: string = ''\n  isChangingEmail: boolean = false\n\n  private emailRegex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$/\n  constructor(\n    private toastrService: ToastService,\n    private translateService: TranslateService,\n    private accountService: AccountService\n  ) {\n    effect(() => {\n      this.cyclistState = this.accountService.cyclistState()\n      // Initialiser emailValue avec l'email du cycliste\n      if (\n        this.cyclistState.state !== 'unknown' &&\n        this.cyclistState.state !== 'error' &&\n        this.cyclistState.cyclist?.email\n      ) {\n        this.emailValue = this.cyclistState.cyclist.email\n      }\n    })\n  }\n\n  get isEmailValid(): boolean {\n    return this.emailRegex.test(this.emailValue)\n  }\n\n  get isButtonDisabled(): boolean {\n    const originalEmail =\n      this.cyclistState.state !== 'unknown' &&\n      this.cyclistState.state !== 'error'\n        ? this.cyclistState.cyclist?.email || ''\n        : ''\n    return this.emailValue === originalEmail || !this.isEmailValid\n  }\n\n  async changeEmail() {\n    if (this.isButtonDisabled || this.isChangingEmail) {\n      return\n    }\n\n    this.isChangingEmail = true\n\n    try {\n      await this.accountService.changeEmail(this.emailValue)\n    } catch (error) {\n      // L'erreur est déjà gérée dans le service avec un toast\n      console.error('Error changing email:', error)\n    } finally {\n      this.isChangingEmail = false\n    }\n  }\n}\n", "<app-header [defaultHref]=\"'/account/settings'\"></app-header>\n<ion-content>\n  <ion-content class=\"ion-padding\">\n    <ion-row class=\"ion-justify-content-center\">\n      <ion-col size=\"12\" size-md=\"8\" size-lg=\"6\">\n        <h1 class=\"ion-margin\">{{ 'settings.infos.title' | translate }}</h1>\n        @if(cyclistState && cyclistState.state !== 'unknown' &&\n        cyclistState.state !== 'error') {\n        <ion-list [inset]=\"true\" mode=\"ios\" lines=\"full\">\n          <ion-item color=\"grey\">\n            <ion-label>{{ cyclistState.cyclist.name }}</ion-label>\n          </ion-item>\n          <ion-item color=\"grey\">\n            <ion-label>{{ cyclistState.cyclist.phone_number }}</ion-label>\n          </ion-item>\n          <ion-item color=\"grey\">\n            <ion-input\n              [(ngModel)]=\"emailValue\"\n              type=\"email\"\n              [class.ion-invalid]=\"emailValue && !isEmailValid\"\n              placeholder=\"{{ 'generic.email' | translate }}\"\n            >\n              <ion-button\n                slot=\"end\"\n                color=\"primary\"\n                fill=\"outline\"\n                [disabled]=\"isButtonDisabled || isChangingEmail\"\n                (click)=\"changeEmail()\"\n              >\n                @if(isChangingEmail) {\n                <ion-spinner name=\"dots\" style=\"max-height: 20px\"></ion-spinner>\n                } @else { {{ 'generic.edit' | translate }} }\n              </ion-button>\n            </ion-input>\n          </ion-item>\n          @if(emailValue && !isEmailValid) {\n          <ion-note color=\"danger\" class=\"ion-padding-start\">\n            {{ 'settings.infos.errors.invalid_email' | translate }}\n          </ion-note>\n          }\n        </ion-list>\n        <div class=\"ion-margin-horizontal\">\n          <ion-note color=\"medium\"\n            >{{ 'settings.infos.email_changed_note' | translate }}\n          </ion-note>\n        </div>\n        }\n      </ion-col>\n    </ion-row>\n  </ion-content>\n</ion-content>\n"],
  "mappings": "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",
  "names": []
}
