{"version":3,"sources":["node_modules/@capacitor/geolocation/dist/esm/index.js","src/app/components/modals/browser-geolocation-instructions/browser-geolocation-instructions.component.ts","src/app/components/modals/browser-geolocation-instructions/browser-geolocation-instructions.component.html","src/app/services/utils/geolocation.service.ts","src/app/services/api-wrappers/stations.service.ts"],"sourcesContent":["import { registerPlugin } from '@capacitor/core';\nimport { exposeSynapse } from '@capacitor/synapse';\nconst Geolocation = registerPlugin('Geolocation', {\n  web: () => import('./web').then(m => new m.GeolocationWeb())\n});\nexposeSynapse();\nexport * from './definitions';\nexport { Geolocation };\n","import { CommonModule } from '@angular/common'\nimport { Component, OnInit } from '@angular/core'\nimport {\n  IonButton,\n  IonRow,\n  IonCol,\n  IonText,\n  ModalController,\n} from '@ionic/angular/standalone'\nimport { TranslateModule } from '@ngx-translate/core'\nimport { StorageService } from 'src/app/services/utils/storage.service'\n\n@Component({\n  selector: 'app-browser-geolocation-instructions',\n  templateUrl: './browser-geolocation-instructions.component.html',\n  styleUrls: ['./browser-geolocation-instructions.component.scss'],\n  imports: [IonButton, IonRow, IonCol, CommonModule, TranslateModule],\n})\nexport class BrowserGeolocationInstructionsComponent implements OnInit {\n  browserName: string\n  program: string\n\n  constructor(\n    private modalCtrl: ModalController,\n    private storage: StorageService\n  ) {\n    this.browserName = this.detectBrowser()\n  }\n  async ngOnInit() {\n    await this.storage.get('program').then((program) => {\n      this.program = program.name\n    })\n  }\n  closeModal() {\n    this.modalCtrl.dismiss()\n  }\n\n  private detectBrowser(): string {\n    const userAgent = navigator.userAgent\n\n    if (userAgent.indexOf('Chrome') > -1) {\n      return 'chrome'\n    } else if (userAgent.indexOf('Safari') > -1) {\n      return 'safari'\n    } else if (userAgent.indexOf('Firefox') > -1) {\n      return 'firefox'\n    } else if (\n      userAgent.indexOf('MSIE') > -1 ||\n      userAgent.indexOf('Trident') > -1\n    ) {\n      return 'ie'\n    } else if (userAgent.indexOf('Edge') > -1) {\n      return 'edge'\n    } else {\n      return 'unknown'\n    }\n  }\n}\n","<div class=\"ion-padding\">\n  <h2>{{ 'map.browser_geolocation.header' | translate }}</h2>\n  <p>{{ 'map.browser_geolocation.message' | translate }}</p>\n\n  <div class=\"browser-instructions\">\n    <!-- Chrome instructions -->\n    <div *ngIf=\"browserName === 'chrome'\">\n      <h3>{{ 'map.browser_geolocation.chrome.title' | translate }}</h3>\n      <ol>\n        <li>{{ 'map.browser_geolocation.chrome.step1' | translate }}</li>\n        <li>{{ 'map.browser_geolocation.chrome.step2' | translate }}</li>\n        <li>{{ 'map.browser_geolocation.chrome.step3' | translate }}</li>\n        <li>{{ 'map.browser_geolocation.chrome.step4' | translate }}</li>\n      </ol>\n      <a\n        href=\"https://support.google.com/chrome/answer/142065?hl=fr&co=GENIE.Platform%3DDesktop\"\n        target=\"_blank\"\n        rel=\"noopener noreferrer\"\n      >\n        {{ 'map.browser_geolocation.chrome.documentation' | translate }}\n      </a>\n    </div>\n\n    <!-- Firefox instructions -->\n    <div *ngIf=\"browserName === 'firefox'\">\n      <h3>{{ 'map.browser_geolocation.firefox.title' | translate }}</h3>\n      <ol>\n        <li>{{ 'map.browser_geolocation.firefox.step1' | translate }}</li>\n        <li>{{ 'map.browser_geolocation.firefox.step2' | translate }}</li>\n      </ol>\n    </div>\n\n    <!-- Safari instructions -->\n    <div *ngIf=\"browserName === 'safari'\">\n      <h3>{{ 'map.browser_geolocation.safari.title' | translate }}</h3>\n      <ol>\n        <li>\n          {{\n            'map.browser_geolocation.safari.step1'\n              | translate : { program: program }\n          }}\n        </li>\n        <li>{{ 'map.browser_geolocation.safari.step2' | translate }}</li>\n      </ol>\n    </div>\n\n    <!-- Generic instructions for other browsers -->\n    <div *ngIf=\"['edge', 'ie', 'unknown'].includes(browserName)\">\n      <h3>{{ 'map.browser_geolocation.generic.title' | translate }}</h3>\n      <ol>\n        <li>{{ 'map.browser_geolocation.generic.step1' | translate }}</li>\n        <li>{{ 'map.browser_geolocation.generic.step2' | translate }}</li>\n        <li>{{ 'map.browser_geolocation.generic.step3' | translate }}</li>\n      </ol>\n    </div>\n  </div>\n\n  <ion-row class=\"ion-text-end\">\n    <ion-col>\n      <ion-button color=\"primary\" (click)=\"closeModal()\">\n        {{ 'generic.close' | translate }}\n      </ion-button>\n    </ion-col>\n  </ion-row>\n</div>\n","import { Injectable } from '@angular/core'\nimport { Capacitor } from '@capacitor/core'\nimport { App } from '@capacitor/app'\nimport { Geolocation, Position } from '@capacitor/geolocation'\nimport { TranslateService } from '@ngx-translate/core'\nimport { BehaviorSubject } from 'rxjs'\nimport { AlertController } from '@ionic/angular/standalone'\nimport {\n  NativeSettings,\n  AndroidSettings,\n  IOSSettings,\n} from 'capacitor-native-settings'\nimport { ModalController } from '@ionic/angular/standalone'\nimport { BrowserGeolocationInstructionsComponent } from 'src/app/components/modals/browser-geolocation-instructions/browser-geolocation-instructions.component'\nimport { ErrorHandlerService } from './error-handler.service'\n\nexport type GeolocationState =\n  | {\n      state: 'idle'\n    }\n  | {\n      state: 'granted'\n    }\n  | {\n      state: 'denied'\n    }\n  | {\n      state: 'unique_position'\n      position: Position\n    }\n  | {\n      state: 'live_position'\n      position: Position\n      watchId: string\n    }\n  | {\n      state: 'prompt'\n    }\n  | {\n      state: 'error'\n      error: string\n    }\n@Injectable({\n  providedIn: 'root',\n})\nexport class GeolocationService {\n  geolocationState: BehaviorSubject<GeolocationState> =\n    new BehaviorSubject<GeolocationState>({\n      state: 'idle',\n    })\n  private resumeListener: any\n  private activeWatchId: string | null = null\n  private positionTimer: any = null\n  private lastPositionUpdate: number = 0\n  private readonly POSITION_UPDATE_INTERVAL = 30000 // 30 seconds in milliseconds\n\n  constructor(\n    private alertController: AlertController,\n    private translate: TranslateService,\n    private modalController: ModalController,\n    private errorHandler: ErrorHandlerService\n  ) {\n    // Setup resume listener\n    this.resumeListener = App.addListener('resume', () => {\n      this.checkPermission()\n    })\n  }\n\n  private startPositionTimer() {\n    // Clear any existing timer\n    this.stopPositionTimer()\n\n    // Start new timer\n    this.positionTimer = setInterval(() => {\n      const now = Date.now()\n      if (now - this.lastPositionUpdate >= this.POSITION_UPDATE_INTERVAL) {\n        this.getPosition()\n      }\n    }, this.POSITION_UPDATE_INTERVAL)\n  }\n\n  private stopPositionTimer() {\n    if (this.positionTimer) {\n      clearInterval(this.positionTimer)\n      this.positionTimer = null\n    }\n  }\n\n  /*********** CAPACITOR/GEOLOCATION ***********/\n  async checkPermission() {\n    await Geolocation.checkPermissions().then((permission) => {\n      if (\n        permission.location === 'granted' ||\n        permission.coarseLocation === 'granted'\n      ) {\n        this.geolocationState.next({ state: 'granted' })\n      } else if (\n        permission.location === 'denied' &&\n        permission.coarseLocation === 'denied'\n      ) {\n        this.geolocationState.next({ state: 'denied' })\n      } else {\n        this.geolocationState.next({ state: 'prompt' })\n      }\n    })\n  }\n  async presentDeniedPositionAlert() {\n    // For native platforms, use the existing alert\n    if (Capacitor.isNativePlatform()) {\n      let buttons: { text: string; role?: string; handler?: () => void }[] = [\n        {\n          text: this.translate.instant('map.denied_position_alert.button'),\n          role: 'cancel',\n        },\n        {\n          text: this.translate.instant('map.denied_position_alert.settings'),\n          handler: () => {\n            NativeSettings.open({\n              optionAndroid: AndroidSettings.ApplicationDetails,\n              optionIOS: IOSSettings.App,\n            })\n          },\n        },\n      ]\n\n      const alert = await this.alertController.create({\n        header: this.translate.instant('map.denied_position_alert.header'),\n        subHeader: this.translate.instant(\n          'map.denied_position_alert.subheader'\n        ),\n        message: this.translate.instant('map.denied_position_alert.message'),\n        buttons: buttons,\n      })\n      await alert.present()\n    }\n    // For web platforms, show a modal with browser-specific instructions\n    else {\n      const browserInstructionsModal = await this.modalController.create({\n        component: BrowserGeolocationInstructionsComponent,\n        cssClass: 'dialog-modal',\n      })\n      await browserInstructionsModal.present()\n    }\n  }\n  async askForPermission() {\n    //IF ON MOBILE, REQUEST PERMISSIONS\n    if (Capacitor.isNativePlatform()) {\n      await Geolocation.requestPermissions().then((permission) => {\n        if (\n          permission.location === 'granted' ||\n          permission.coarseLocation === 'granted'\n        ) {\n          this.geolocationState.next({ state: 'granted' })\n        } else if (\n          permission.location === 'denied' &&\n          permission.coarseLocation === 'denied'\n        ) {\n          this.geolocationState.next({ state: 'denied' })\n        } else {\n          this.geolocationState.next({ state: 'prompt' })\n        }\n      })\n    } else {\n      //IF ON WEB\n      if (navigator.geolocation) {\n        navigator.geolocation.getCurrentPosition(\n          (success) => {\n            this.geolocationState.next({\n              state: 'unique_position',\n              position: success,\n            })\n          },\n          (error) => {\n            if (error.message === 'User denied Geolocation') {\n              this.geolocationState.next({\n                state: 'denied',\n              })\n            } else {\n              this.geolocationState.next({\n                state: 'error',\n                error: error.message,\n              })\n            }\n          }\n        )\n      }\n    }\n  }\n  async getPosition(forceUpdate: boolean = false) {\n    const now = Date.now()\n    if (\n      !forceUpdate &&\n      now - this.lastPositionUpdate < this.POSITION_UPDATE_INTERVAL\n    ) {\n      return\n    }\n\n    if (Capacitor.isNativePlatform()) {\n      if (this.geolocationState.value.state === 'granted') {\n        await Geolocation.getCurrentPosition()\n          .then((position) => {\n            this.lastPositionUpdate = now\n            this.geolocationState.next({\n              state: 'unique_position',\n              position,\n            })\n            // Start timer when we get a position\n            this.startPositionTimer()\n          })\n          .catch((error) => {\n            this.errorHandler.handleError(error)\n            this.stopPositionTimer()\n          })\n      }\n    } else {\n      if (navigator.geolocation) {\n        navigator.geolocation.getCurrentPosition(\n          (success) => {\n            this.lastPositionUpdate = now\n            this.geolocationState.next({\n              state: 'unique_position',\n              position: success,\n            })\n            // Start timer when we get a position\n            this.startPositionTimer()\n          },\n          (error) => {\n            if (error.message === 'User denied Geolocation') {\n              this.geolocationState.next({\n                state: 'denied',\n              })\n            } else {\n              this.geolocationState.next({\n                state: 'error',\n                error: error.message,\n              })\n            }\n            this.stopPositionTimer()\n          }\n        )\n      }\n    }\n  }\n  async watchPosition() {\n    if (this.isPositionGranted()) {\n      // If there's already an active watch, don't start a new one\n      if (this.activeWatchId) {\n        return\n      }\n\n      const watchId = Math.random().toString()\n      this.activeWatchId = watchId\n\n      // Start the watch for real-time updates\n      await Geolocation.watchPosition(\n        {\n          enableHighAccuracy: true,\n          timeout: 30000,\n          maximumAge: 10000,\n        },\n        (position) => {\n          if (position && position.coords && this.activeWatchId) {\n            this.geolocationState.next({\n              state: 'live_position',\n              position,\n              watchId: this.activeWatchId,\n            })\n          }\n        }\n      ).catch((error) => {\n        this.errorHandler.handleError(error)\n        this.activeWatchId = null\n        this.geolocationState.next({\n          state: 'error',\n          error: error.message,\n        })\n      })\n    }\n  }\n\n  isPositionGranted() {\n    return (\n      this.geolocationState.value.state === 'granted' ||\n      this.geolocationState.value.state === 'unique_position' ||\n      this.geolocationState.value.state === 'live_position'\n    )\n  }\n  async unwatchPosition() {\n    if (this.geolocationState.value.state === 'live_position') {\n      await Geolocation.clearWatch({\n        id: this.geolocationState.value.watchId,\n      })\n      this.activeWatchId = null\n    }\n  }\n  goBackToIdle() {\n    this.geolocationState.next({ state: 'idle' })\n  }\n  /*********** UTILS ***********/\n  private deg2rad(deg: number): number {\n    return deg * (Math.PI / 180)\n  }\n  openMaps(\n    latitude: string | number | undefined,\n    longitude: string | number | undefined,\n    travelMode: 'walking' | 'driving' | 'bicycling' | 'transit' = 'walking'\n  ): void {\n    const lat = typeof latitude === 'string' ? parseFloat(latitude) : latitude\n    const lng =\n      typeof longitude === 'string' ? parseFloat(longitude) : longitude\n\n    if (\n      typeof lat === 'number' &&\n      typeof lng === 'number' &&\n      !isNaN(lat) &&\n      !isNaN(lng)\n    ) {\n      const url = `https://www.google.com/maps/dir/?api=1&destination=${lat},${lng}&travelmode=${travelMode}`\n      window.open(url, '_blank')\n    }\n  }\n  calculateDistance(\n    firstPosition: { latitude: number; longitude: number },\n    secondPosition: { latitude: number; longitude: number }\n  ): number {\n    const R = 6371000 // Earth's radius in meters\n    const dLat = this.deg2rad(secondPosition.latitude - firstPosition.latitude)\n    const dLon = this.deg2rad(\n      secondPosition.longitude - firstPosition.longitude\n    )\n    const a =\n      Math.sin(dLat / 2) * Math.sin(dLat / 2) +\n      Math.cos(this.deg2rad(firstPosition.latitude)) *\n        Math.cos(this.deg2rad(secondPosition.latitude)) *\n        Math.sin(dLon / 2) *\n        Math.sin(dLon / 2)\n    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a))\n    return Math.round(R * c)\n  }\n\n  // N'oubliez pas de nettoyer le listener quand le service est détruit\n  ngOnDestroy() {\n    if (this.resumeListener) {\n      this.resumeListener.remove()\n    }\n  }\n}\n","import { Injectable } from '@angular/core'\nimport { BehaviorSubject } from 'rxjs'\nimport {\n  ListVehicule200ResponseAllOfDataInner,\n  StationsService,\n  ListStation200ResponseAllOfDataInner,\n} from 'src/api-cyclist'\nimport { GeolocationService } from '../utils/geolocation.service'\nimport { StorageService } from '../utils/storage.service'\nimport { environment } from 'src/environments/environment'\n\nexport type StationState =\n  | { state: 'no-station' }\n  | {\n      state: 'favorites-stations'\n    }\n  | { state: 'station-selected'; station: ListStation200ResponseAllOfDataInner }\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class StationWrapperService {\n  private stationState = new BehaviorSubject<StationState>({\n    state: 'no-station',\n  })\n  stationState$ = this.stationState.asObservable()\n\n  constructor(\n    private geolocationService: GeolocationService,\n    private storage: StorageService,\n    private stationsService: StationsService\n  ) {}\n\n  setStationState(\n    state: 'no-station' | 'station-selected' | 'favorites-stations',\n    station?: ListStation200ResponseAllOfDataInner\n  ) {\n    switch (state) {\n      case 'favorites-stations':\n        this.stationState.next({ state: 'favorites-stations' })\n        break\n      case 'no-station':\n        this.stationState.next({ state: 'no-station' })\n        break\n      case 'station-selected':\n        if (station) {\n          this.stationState.next({\n            state: 'station-selected',\n            station: station,\n          })\n        } else {\n          this.stationState.next({ state: 'no-station' })\n        }\n        break\n    }\n  }\n\n  getState(): StationState {\n    return this.stationState.getValue()\n  }\n\n  async getNearbyStations(\n    position: { latitude: number; longitude: number },\n    radius: number,\n    expandVehicles?: boolean\n  ) {\n    // Get stations based on expandVehicles flag\n    let stations: ListStation200ResponseAllOfDataInner[]\n    if (expandVehicles) {\n      stations = await new Promise((resolve) => {\n        this.stationsService\n          .listStation({\n            program: environment.program,\n            expand: ['vehicules'],\n          })\n          .subscribe((response) => resolve(response.data))\n      })\n    } else {\n      stations = (await this.storage.get('stations')).data\n    }\n\n    // Filter stations based on distance\n    return stations.filter((station) => {\n      if (!station.position) return false\n      const distance = this.geolocationService.calculateDistance(position, {\n        latitude: Number(station.position.latitude),\n        longitude: Number(station.position.longitude),\n      })\n      return distance <= radius\n    })\n  }\n\n  async refreshStations(forceRefresh: boolean = false): Promise<void> {\n    return new Promise<void>(async (resolve) => {\n      const stations = await this.storage.get('stations')\n\n      // Si les stations sont en cache et à jour, on résout immédiatement\n      if (\n        stations &&\n        stations.lastUpdate &&\n        Date.now() - stations.lastUpdate < 1000 * 30 &&\n        !forceRefresh\n      ) {\n        resolve()\n        return\n      }\n\n      // Fonction récursive pour charger toutes les pages\n      const loadAllStations = (\n        lastId: string | null = null,\n        allStations: any[] = []\n      ): void => {\n        const params: any = {\n          liveMode: environment.production,\n          program: environment.program,\n          limit: 100,\n        }\n\n        if (lastId) {\n          params.startingAfter = lastId\n        }\n\n        this.stationsService.listStation(params).subscribe({\n          next: async (response) => {\n            const combinedStations = [...allStations, ...response.data]\n\n            if (response.has_more && response.data.length > 0) {\n              const lastStation = response.data[response.data.length - 1]\n              loadAllStations(lastStation.id, combinedStations)\n            } else {\n              await this.storage.set('stations', {\n                data: combinedStations,\n                lastUpdate: Date.now(),\n              })\n              resolve()\n            }\n          },\n          error: async (error) => {\n            console.error('Error loading stations:', error)\n            if (allStations.length > 0) {\n              await this.storage.set('stations', {\n                data: allStations,\n                lastUpdate: Date.now(),\n              })\n            }\n            resolve()\n          },\n        })\n      }\n\n      // Démarrer le chargement des stations\n      loadAllStations()\n    })\n  }\n\n  getBestVehicles(\n    vehicles: ListVehicule200ResponseAllOfDataInner[],\n    amount: number\n  ): ListVehicule200ResponseAllOfDataInner[] {\n    if (!vehicles?.length || amount <= 0) {\n      return []\n    }\n\n    return vehicles\n      .filter((vehicle) => vehicle?.battery_vae?.percent != null)\n      .sort((vehicleA, vehicleB) => {\n        const batteryA = vehicleA.battery_vae?.percent ?? 0\n        const batteryB = vehicleB.battery_vae?.percent ?? 0\n        return batteryB - batteryA\n      })\n      .slice(0, amount)\n  }\n}\n"],"mappings":"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","names":[],"x_google_ignoreList":[0]}