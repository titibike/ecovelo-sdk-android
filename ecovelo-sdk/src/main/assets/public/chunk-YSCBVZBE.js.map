{
  "version": 3,
  "sources": ["src/app/services/internal/appstate.service.ts"],
  "sourcesContent": ["import { Injectable } from '@angular/core'\nimport { BehaviorSubject } from 'rxjs'\nimport { StorageService } from '../utils/storage.service'\n\nexport type AppState =\n  | {\n      state: 'launch'\n    }\n  | {\n      state: 'onboarding'\n    }\n  | {\n      state: 'no_cyclist'\n      trip_started?: number\n    }\n  | {\n      state: 'new_cyclist'\n      dring_state: {\n        geolocation_dring: 'not_shown' | 'shown'\n      }\n      push_notifications: 'not_shown' | 'shown'\n    }\n  | {\n      state: 'fresh_cyclist'\n      trip_started?: number\n      dring_state: {\n        geolocation_dring: 'not_shown' | 'shown'\n      }\n      push_notifications: 'not_shown' | 'shown'\n    }\n  | {\n      state: 'regular_cyclist'\n      trip_started?: number\n    }\n  | {\n      state: 'passionate_cyclist'\n      trip_started?: number\n    }\n  | {\n      state: 'deleting_cyclist'\n      trip_started?: number\n    }\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class AppstateService {\n  appState = new BehaviorSubject<AppState>({\n    state: 'launch',\n  })\n\n  constructor(private storage: StorageService) {\n    this.getSavedAppState().then((state) => {\n      if (state) {\n        this.appState.next(state)\n      }\n    })\n  }\n\n  async setAppState(state: AppState) {\n    this.appState.next(state)\n    await this.saveAppState()\n  }\n\n  getAppState() {\n    return this.appState.value\n  }\n\n  async saveAppState() {\n    await this.storage.set('appState', this.appState.value)\n  }\n\n  getSavedAppState() {\n    return this.storage.get('appState')\n  }\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;AA8CM,IAAO,mBAAP,MAAO,iBAAe;EAK1B,YAAoB,SAAuB;AAAvB,SAAA,UAAA;AAJpB,SAAA,WAAW,IAAI,gBAA0B;MACvC,OAAO;KACR;AAGC,SAAK,iBAAgB,EAAG,KAAK,CAAC,UAAS;AACrC,UAAI,OAAO;AACT,aAAK,SAAS,KAAK,KAAK;MAC1B;IACF,CAAC;EACH;EAEM,YAAY,OAAe;;AAC/B,WAAK,SAAS,KAAK,KAAK;AACxB,YAAM,KAAK,aAAY;IACzB;;EAEA,cAAW;AACT,WAAO,KAAK,SAAS;EACvB;EAEM,eAAY;;AAChB,YAAM,KAAK,QAAQ,IAAI,YAAY,KAAK,SAAS,KAAK;IACxD;;EAEA,mBAAgB;AACd,WAAO,KAAK,QAAQ,IAAI,UAAU;EACpC;;;mCA5BW,kBAAe,mBAAA,cAAA,CAAA;AAAA;oFAAf,kBAAe,SAAf,iBAAe,WAAA,YAFd,OAAM,CAAA;AAEd,IAAO,kBAAP;;sEAAO,iBAAe,CAAA;UAH3B;WAAW;MACV,YAAY;KACb;;;",
  "names": []
}
